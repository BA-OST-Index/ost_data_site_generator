{% extends "template/en/base.html" %}

{% block title %}Track/{{ track.name.realname.en }}{% endblock title %}
{% block article_content %}
    {% from "template/en/_macro_page.html" import output_usedby_background, output_usedby_story, output_usedby_battle, output_usedby_ui, output_usedby_video, output_usedby_character_dict, track_version_video_player, output_track_album %}
    {% from "template/en/_macro.html" import tracktype_to_name, generate_album_anchor, generate_track_anchor, output_track_stat_badge_all, generate_character_anchor %}
    {% from "template/en/_macro_page2.html" import track_stats_table, output_track_playback_table %}

    <h1>Track/{{ track.no }}. {{ track.name.realname.en }} {{ output_track_stat_badge_all(track.stats) }}</h1>
    {% include "template/en/infobox/track.html" %}
    <p><b>{{ track.name.realname.en }}</b> is the No. {{ track.no }} track in the {{ tracktype_to_name(track.track_type) }}.</p>
    <p>{{ track.desc.en }}</p>

    <h2>Name Translation</h2>
    <h3>Original Names</h3>
    <ul>
        <li>English: {{ track.name.realname.en }}</li>
        <li>中文简体 (Chinese Simplified): {{ track.name.realname.zh_cn }}</li>
        <li>中文繁體 (Chinese Traditional): {{ track.name.realname.zh_tw }}</li>
    </ul>
    <h3>Other Names</h3>
    <ul>
        {% for i in track.name.known_as %}
            <li>{{ i.en }} / {{ i.zh_cn }} / {{ i.zh_tw }}</li>
        {% else %}
            <li>Nothing to show!</li>
        {% endfor %}
    </ul>

    <h2>Track in Album</h2>
    <p>This track has been included in the following albums.</p>
    {{ output_track_album(track.album, track) }}

    <h2>In-Game Playback Info</h2>
    <p>The following data is generated by in-game files.</p>
    {{ output_track_playback_table(track.playback_info) }}
    <h2>Play Music Here</h2>
    <p>Tips: In order to avoid potential copyright infringement, we're using <b>third-party embedded web players</b> to provide services. You can also manually visit them by clicking the links in the infobox.</p>
    <p>By clicking the links below, you agree to the Terms of Services of the corresponding platforms/service providers.</p>
    {{ track_version_video_player(track.version) }}

    <h2>Track Stats</h2>
    {{ track_stats_table(track.stats) }}
    <h3>Recollection Lobby Characters</h3>
    <p>The recollection lobbies of the listed characters use this track.</p>
    <ul>
        {% for i in track.bond_chars %}
            {% set bond_tooltip = generate_tooltip_id("character", i.uuid) %}
            <li>{{ generate_character_anchor(i, 1, 1, "track-" + track.instance_id, bond_tooltip, 0, 0, 0, 0) }}</li>
        {% endfor %}
    </ul>

    <h2>Usage Info</h2>
    <p>This section shows instances where the song has been referenced.</p>
    <h3>Related Tracks</h3>
    <ul>
        {% for i in track.related_to.track_other %}<li>{{ generate_track_anchor(i, 0, 0, 0, 0, 1) }}</li>{% else %}<li>No tracks!</li>{% endfor %}
    </ul>
    <h3>Backgrounds</h3>
    {{ output_usedby_background(track.used_by.data_background, "track-" + track.instance_id, track.instance_id, "track") }}
    <h3>Stories</h3>
    {{ output_usedby_story(track.used_by.data_story, track.uuid, "track") }}
    <h3>Battles</h3>
    {{ output_usedby_battle(track.used_by.data_battle) }}
    <h3>UIs</h3>
    {{ output_usedby_ui(track.used_by.data_ui) }}
    <h3>Videos</h3>
    {{ output_usedby_video(track.used_by.data_video, "track-" + track.instance_id) }}
    <h3>Characters</h3>
    <p>Note: The following list is sorted by mainly the reference count (the number showed below).</p>
    {{ output_usedby_character_dict(track.used_by.data_character, "track-" + track.instance_id, track.instance_id, "track") }}
{% endblock article_content %}